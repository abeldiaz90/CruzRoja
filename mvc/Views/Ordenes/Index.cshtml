@model mvc.Models.Ordenes
@{
	ViewBag.Title = "Index";
	Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="container">
	<div class="row justify-content-md-center">
		<div class="col col-lg-2">
		</div>
		<div class="col-md-auto">
		</div>
		<div class="col col-lg-2">

		</div>
	</div>
	<div class="row">
		<div class="col">

		</div>
		<div class="col-md-auto">
			@DateTime.Now
		</div>
		<div class="col col-lg-2">
			<button type="button" class="btn btn-primary">
				Folio: <span class="badge badge-light">	@Html.DisplayFor(model => model.Id)</span>
			</button>
		</div>
	</div>
</div>
<h3>Ordenes de Servicio</h3>


@using (Html.BeginForm("Agregar", "Ordenes", FormMethod.Post, new { @class = "form", id = "Formulario" }))
{
	@Html.AntiForgeryToken();
	@Html.ValidationSummary(true);
	@Html.Partial("Pacientes")


	<div id="myPartialViewDiv">
		@{
			Html.RenderPartial("OrdenesTemporal", Model.ordenestemporalvista);
		}
	</div>
}
<script>
	$(document).ready(function () {
		$('#ordentemporal_IdServicio').on('change', function () {
			var Id = $('#ordentemporal_IdServicio').val();
			var obj = { IdServicio: Id };
			AjaxCall('/ServiciosPrecios/ConsultaPrecios/' + obj.IdServicio, JSON.stringify(obj), 'POST').done(function (response) {
				if (response.length > 0) {
					var options = '';
					options += '<option value="Select">Seleccione el Precio</option>';
					for (var i = 0; i < response.length; i++) {
						options += '<option value="' + response[i].Id + '">' + '$ ' + response[i].PrecioSinIva + '.00' + '</option>';
					}
					$('#ordentemporal_IdPrecio').html('');
					$('#ordentemporal_IdPrecio').append(options);

				} else {$('#ordentemporal_IdPrecio').html(''); }
			}).fail(function (error) {
					$('#ordentemporal_IdPrecio').html('');
				alert(error.StatusText);
			});
		});
	});

	function AjaxCall(url, data, type) {
		return $.ajax({
			url: url,
			type: type ? type : 'GET',
			data: data,
			contentType: 'application/json'
		});
	}
</script>